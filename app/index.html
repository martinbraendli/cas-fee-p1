<!DOCTYPE html>
<html>
<head lang="de">
    <meta charset="UTF-8">

    <title>Reh-Minder -Project CAS FEE 01 by Martin & Felix</title>

    <link rel="icon" href="pix/reh_small_red.png" type="image/x-icon">
    <!--<link rel="stylesheet" href="css/normalize.css"/>-->
    <link href='http://fonts.googleapis.com/css?family=Julius+Sans+One|Glegoo:400,700' rel='stylesheet' type='text/css'>
    <!--layout style-sheet -->
    <link rel="stylesheet" href="css/styles.css"/>
    <link rel="stylesheet" href="css/jquery.datetimepicker.css"/>
    <!--theme style sheet -> start with redwhite -->
    <link rel="stylesheet" id="themeCss" href="css/redwhite.css"/>

    <!--link js sources-->
    <script src="js/lib/handlebars-v3.0.3.js" type="text/javascript"></script>
    <script src="js/lib/jquery-1.11.js"></script>
    <script src="js/lib/jquery.datetimepicker.js"></script>

    <script src="js/model/Note.js"></script>
    <script src="js/NoteFactory.js"></script>
    <script src="js/NoteProDAL.js"></script>
    <script src="js/NoteProController.js"></script>

    <!--Template view list entry -->
    <script id="viewNoteEntry" type="text/x-handlebars-template">
        <!--loop all tasks here-->
        {{#each this}}
        <div class="tasklistrow">
            <div class="list-elem task-date">
                <p>{{formatDate dateFinishUntil}}</p>
                {{#if finished}}
                <input type="checkbox" name="taskdone" value="finished" label="finished" checked
                       onclick="NoteProController.finishNote({{this.id}})"/>
                {{else}}
                <input type="checkbox" name="taskdone" value="finished" label="finished"
                       onclick="NoteProController.finishNote({{this.id}})"/>
                {{/if}}
                Finished{{#if finished}} ({{formatDate dateFinished}}){{/if}}
            </div>
            <div class="list-elem task-desc">
                <h4>{{title}}</h4>

                <p>{{text}}</p>
            </div>
            <div class="list-elem task-importance">
                <span>
                    {{formatImportance importance}}
                </span>
            </div>
            <div class="list-elem task-edit-btn">
                <a onclick="NoteProController.showEditScreen({{id}})" href="#">Edit Note</a>
            </div>
        </div>
        {{/each}}
    </script>

    <script id="importanceIcons" type="text/x-handlebars-template">
        {{formatImportance this}}
    </script>
</head>
<body>
<!--pop-up screens - Display: none by default -->
<div class="popup" id="TaskDone">
    <div class="overlay">
        <div class="message">
            <h2>Well Done!</h2>
            <br />
            <p>You have Completed your Task [task-name here] successfully.</p>
            <a href="index.html" >Cool, next Task</a>
        </div>
    </div>
</div>
<div class="popup" id="TaskFailed">
    <div class="overlay">
        <div class="message">
            <h2>Dude!</h2>
            <br />
            <p>You have reached the Deadline of Task [task-name here] without completing your Task...</p>
            <a href="index.html" >Okay, I have to do note it again</a>
        </div>
    </div>
</div>
<!--markup starts here-->
<div id="wrapper">
    <header class="head clearfix">
        <img src="pix/reh-icon1.png">

        <h1>Reh-Minder</h1>
        <h2>brought you by Martin & Felix </h2>
        <!--PROVISORISCH MAL hier -->
        <div id="statusindicator" class="green">
            <h2>Task Timer Status Indicator</h2>
        </div>
    </header>
    <main>
        <div class="mainwrapper">
            <div class="menu-styles clearfix2">
                <div class="btn task-add-btn prominent">
                    <a href="#" id="addNote"
                       onclick="NoteProController.showEditScreen()">Add a Note</a>
                </div>
                <div class="style-chooser">
                    <span>Choose your Style</span>
                    <select id="ThemeChooser">
                        <option id="br" value="css/redwhite.css">Red and White</option>
                        <option id="ob" value="css/blackorange.css">Orange is the new Black</option>
                        <option id="pb" value="css/pinkblack.css">Pink is the new Black</option>
                        <option id="bw" value="css/watherclean.css">Bright Wather</option>
                    </select>
                </div>
            </div>
            <div class="sort-styles">
                <h3>Sort all my Notes</h3>
                <ul>
                    <li>
                        <a href="#" id="byFinishDate"
                           onclick="NoteProController.switchOrderBy(this)">Show by Finish Date</a>
                    </li>
                    <li>
                        <a href="#" id="byCreateDate"
                           onclick="NoteProController.switchOrderBy(this)">Show by Create Date</a>
                    </li>
                    <li>
                        <a href="#" id="byImportance"
                           onclick="NoteProController.switchOrderBy(this)">Show by Importance</a>
                    </li>
                    <li class="showrightside">
                        <a href="#" id="showAllCompleted"
                           onclick="NoteProController.toggleShowAllEntries()">...</a>
                    </li>
                </ul>
            </div>
            <div id="listnotes" class="listnotes">
                <div class="listheader">
                    <div class="list-head-elem">
                        Due Date
                    </div>
                    <div class="list-head-elem">
                        Task
                    </div>
                    <div class="list-head-elem">
                        Importance
                    </div>
                    <div class="list-head-elem">
                        Edit Note
                    </div>
                </div>
            </div>

            <!--Outer Wrapper for all listed notes-->
            <div id="noteoutput">
                <!-- rendered by template 'viewNoteEntry' -->
            </div>
        </div>
        <!--start view ends here-->
        <!--edit form starts here not visible-->
        <div class="editwrapper">
            <div class="editcontent">
                <input type="hidden" id="currentId"/>

                <div class="editheader">
                    <h3>Add or Edit your Task</h3>
                </div>
                <form class="edittask">
                    <div class="edittaskrow">
                        <div class="taskedit-elem first-cell">
                            <label for="editTitle">Task Title:</label>
                        </div>
                        <div class="taskedit-elem  second-cell">
                            <input id="editTitle" name="tasktitle"
                                   type="text" maxlength="50"/>
                        </div>
                        <div class="taskedit-elem third-cell">
                            &nbsp;
                        </div>
                    </div>
                    <div class="edittaskrow">
                        <div class="taskedit-elem first-cell">
                            <label for="editText">Description:</label>
                        </div>
                        <div class="taskedit-elem second-cell">
                            <textarea id="editText" name="task-desc"
                                      rows="3" maxlength="500">your task goes here..</textarea>
                        </div>
                        <div class="taskedit-elem third-cell">
                            &nbsp;
                        </div>
                    </div>
                    <div class="edittaskrow">
                        <div class="taskedit-elem first-cell">
                            <label for="taskimportance">Importance:</label>
                        </div>
                        <div class="taskedit-elem  second-cell edit-important ">
                            <span>0 &nbsp;<input type="range" max="5" min="0" id="taskimportance"
                                                 onchange="NoteProController.refreshEditView();"/>&nbsp;5 &nbsp;</span>
                            <br/>
                            <span id="importanceEdit">
                                <!-- rendered by template 'importanceIcons' -->
                            </span>
                        </div>
                        <div class="taskedit-elem third-cell">
                            &nbsp;
                        </div>
                    </div>
                    <div class="edittaskrow">
                        <div class="taskedit-elem first-cell">
                          <label for="dateFinishUntil">Deadline:</label>
                        </div>
                        <div class="taskedit-elem second-cell">
                            <input id="dateFinishUntil" type="text"/>
                        </div>
                        <div class="taskedit-elem third-cell">
                            &nbsp;
                        </div>
                    </div>
                    <div class="edittaskrow">
                        <div class="taskedit-elem first-cell">
                            &nbsp;
                        </div>
                        <div class="taskedit-elem second-cell btn prominent">
                            <a href="#" id="submittask"
                               onclick="NoteProController.saveNote()">Save Task</a>
                        </div>
                        <div class="taskedit-elem third-cell btn">
                            <a href="#" id="goback"
                               onclick="NoteProController.showMainScreen(true)">Cancel</a>
                        </div>
                    </div>
                </form>
            </div>
        </div>
    </main>
    <footer>
        <div class="footer clearfix">
            <div class="footer-desc">
                CAS FEE -Projekt 01
            </div>
            <div class="footer-copy">
                &copy; by M & F
            </div>
        </div>
    </footer>
</div>

</body>
<script type="text/javascript">
    $(document).ready(function () {
        console.log("document ready");
        NoteProController.renderListControlls();
        NoteProController.prepareTemplate();
        NoteProController.showAllEntries();
        $('#dateFinishUntil').datetimepicker({
            format:'d.m.Y H:i'
        });

        // Timer Function
        // Filix-js-newbe-Timer function - very basic but fu**ng working... - ja du dörfsch scho lache, isch voll okay Martin! ;-)
        function timer(){
            // Time in Stunden bis deadline für jedes task
            // also etwa date.now - note.dateFinished in h
            var timeToDoTask = 10;
            // Gelbe Warnung: fixer wert vor Ende der Deadline bzw. ausser wir spezifizieren noch wann man erinnert werden möchte.
            var yellowwarningtime =(timeToDoTask -timeToDoTask +5);
            console.log("yellowwarningtime: " +yellowwarningtime);
            // Rote Warnung: fixer Wert vor dem nahen Ende der Deadline.
            var redwarningtime =  (timeToDoTask - timeToDoTask +3);
            console.log("redwarningtime is: " +redwarningtime);
            // status yellowAlert
            var yellowAlert = false;
            // status redAlert
            var redAlert = false;
            // deadline is false per default
            var timeIsUp =  false;

            var setTimerforTask = setInterval(function (){
                console.log("timeToDoTask is: " + timeToDoTask);
                timeToDoTask = (timeToDoTask -1);
                if(timeToDoTask === yellowwarningtime){
                    yellowAlert = true;
                    alert("Yellow: mach jetzt chli");
                    console.log("yellowAlert status: "+ yellowAlert);
                    $('#statusindicator').attr('class','yellow');
                }
                if(timeToDoTask === redwarningtime){
                    redAlert = true;
                    alert("Roter Ree-minder: mach jetzt gäng chli gwing!");
                    console.log("redAlert status: "+ redAlert);
                    $('#statusindicator').attr('class','red');
                }
                if(timeToDoTask === 0){
                    console.log("timer is finshed");
                    timeIsUp = true;
                    alert("GONG - Time is up!");
                    $('#statusindicator').attr('class','missed');
                    // clear Timer for this task
                    clearInterval(setTimerforTask);
                }
                // sollte dann auf 60 sec gestellt werden
            },2000);
        }

        //runtimer
        timer();
    });

</script>

<!--FancyTheme Chooser external-->
<script src="js/ThemeChooser.js"></script>
</html>